TASARIM_RAPORU.md
PROJE VERİTABANI TASARIMI

Veritabanı olarak ilişkisel yapı (Relational DB) tercih edilmiştir. Sistemde şu an iki ana tablo bulunmaktadır:

Tablo: products (Ürünler)

Sistemin temel taşıdır. Tüm market ürünlerinin verisi burada saklanır.

Sütunlar:

id (Integer, PK): Benzersiz kayıt numarası.
barcode (String, Unique): Ürünün barkodu (T.C. No gibi, eşsiz).
name (String): Ürün adı (Örn: Çaykur Rize).
price (Float): Satış fiyatı.
weight (String): Gramaj bilgisi.
image_url (String): Ürün fotoğrafının sunucudaki linki.
description (String): Ürün detay açıklaması.
Tablo: favorites (Favoriler)

Kullanıcıların beğendiği ürünleri saklar.

Sütunlar:

id (Integer, PK): Kayıt numarası.

product_barcode (String): Hangi ürünün favorilendiğini gösteren barkod bilgisi.


VERİTABANI MIGRATION (GÖÇ) STRATEJİSİ

Veritabanı şemasındaki değişiklikleri yönetmek ve veri kaybını önlemek için "Alembic" aracı kullanılacaktır.

Yöntem: Code-First yaklaşımı. (Önce Python kodu yazılır, veritabanı ona göre güncellenir).

Adımlar:

Tablo modelinde değişiklik yapılır (Örn: Ürünlere 'stok adedi' eklenmesi).

alembic revision --autogenerate komutu ile değişiklik algılanır ve bir versiyon dosyası oluşturulur.

alembic upgrade head komutu ile bu değişiklik veritabanına uygulanır.

Avantajı: Veritabanını silip baştan kurmaya gerek kalmadan, canlı sistemdeki veriler korunarak tablolar güncellenebilir

API SERVİS DÖKÜMANI

A. Ürün İşlemleri

1. Ürün Sorgula (GET /product/{barcode_id})

Açıklama: Barkodu okutulan ürünün detaylarını getirir.

Girdi: Barkod Numarası (Örn: 8690637060017)

Çıktı: Ürün adı, fiyatı, resmi ve açıklaması.

Hata: Eğer ürün yoksa 404 Not Found döner.

2. Yeni Ürün Ekle (POST /products/)

Açıklama: Veritabanına yeni bir market ürünü kaydeder.

Girdi (JSON):
{
  "name": "Eti Cin",
  "price": 8.50,
  "barcode": "123456",
  "weight": "25gr"
}

Çıktı: Kaydedilen ürünün veritabanı ID'si ile birlikte teyidi.

B. Resim Servisi

3. Resim Yükle (POST /upload-image/)

Açıklama: Ürün fotoğrafını sunucuya yükler ve bir URL üretir.

Girdi: Dosya (Binary formatında .jpg veya .png)

Çıktı: {"url": "http://server-adresi/static/resim.jpg"}

C. Favori İşlemleri

4. Favoriye Ekle (POST /favorites/add/{barcode_id})

Açıklama: Belirtilen barkoda sahip ürünü favori listesine ekler.

Mantık: Eğer ürün zaten listedeyse tekrar eklemez, uyarı verir.

5. Favorileri Listele (GET /favorites)

Açıklama: Veritabanındaki tüm favori ürünleri listeler.

Çıktı: Ürün objelerinin listesi (Array).